var gdjs;(function(d){const c=new d.Logger("JSON Manager"),i=a=>!!(a.startsWith("https://project-resources.gdevelop.io/")||a.startsWith("https://project-resources-dev.gdevelop.io/"));class u{constructor(n){this._loadedJsons={};this._callbacks={};this._resources=n}setResources(n){this._resources=n}preloadJsons(n,r){const t=this._resources.filter(function(s){return s.kind==="json"&&!s.disablePreload});if(t.length===0)return r(t.length);let o=0;const e=function(s){s&&c.error("Error while preloading a json resource:"+s),o++,o===t.length?r(t.length):n(o,t.length)};for(let s=0;s<t.length;++s)this.loadJson(t[s].name,e)}loadJson(n,r){const l=this._resources.find(function(e){return e.kind==="json"&&e.name===n});if(!l){r(new Error(`Can't find resource with name: "`+n+'" (or is not a json resource).'),null);return}if(this._loadedJsons[n]){r(null,this._loadedJsons[n]);return}{const e=this._callbacks[n];if(e){e.push(r);return}else this._callbacks[n]=[r]}const t=this,o=new XMLHttpRequest;o.responseType="json",o.withCredentials=i(l.file),o.open("GET",l.file),o.onload=function(){const e=t._callbacks[n];if(!!e){if(o.status!==200){for(const s of e)s(new Error("HTTP error: "+o.status+"("+o.statusText+")"),null);delete t._callbacks[n];return}t._loadedJsons[n]=o.response;for(const s of e)s(null,o.response);delete t._callbacks[n]}},o.onerror=function(){const e=t._callbacks[n];if(!!e){for(const s of e)s(new Error("Network error"),null);delete t._callbacks[n]}},o.onabort=function(){const e=t._callbacks[n];if(!!e){for(const s of e)s(new Error("Request aborted"),null);delete t._callbacks[n]}},o.send()}isJsonLoaded(n){return!!this._loadedJsons[n]}getLoadedJson(n){return this._loadedJsons[n]||null}}d.JsonManager=u})(gdjs||(gdjs={}));
//# sourceMappingURL=jsonmanager.js.map
