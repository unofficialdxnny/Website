var gdjs;(function(f){const u=new f.Logger("PIXI Image manager"),l=GlobalPIXIModule.PIXI,c=(s,e)=>{u.error("Unable to load file "+s+" with error:",e||"(unknown error)")},I=(s,e)=>{!s||e.smoothed||(s.baseTexture.scaleMode=l.SCALE_MODES.NEAREST)},A=(s,e,i)=>{for(let n=0,t=s.length;n<t;++n){const r=s[n];if(r.name===e&&r.kind===i)return r}return null},g=s=>!!(s.startsWith("https://project-resources.gdevelop.io/")||s.startsWith("https://project-resources-dev.gdevelop.io/"));class v{constructor(e){this._resources=e,this._invalidTexture=l.Texture.from("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAFElEQVQoU2P8z/D/PwMewDgyFAAApMMX8Zi0uXAAAAAASUVORK5CYIIA"),this._loadedTextures=new Hashtable}setResources(e){this._resources=e}getPIXITexture(e){if(this._loadedTextures.containsKey(e)){const r=this._loadedTextures.get(e);if(r.valid)return r;u.error("Texture for "+e+" is not valid anymore (or never was).")}if(e==="")return this._invalidTexture;const i=A(this._resources,e,"image");if(!i)return u.warn('Unable to find texture for resource "'+e+'".'),this._invalidTexture;u.log('Loading texture for resource "'+e+'"...');const n=i.file,t=l.Texture.from(n,{resourceOptions:{crossorigin:g(n)?"use-credentials":"anonymous"}}).on("error",r=>{c(n,r)});return I(t,i),this._loadedTextures.put(e,t),t}getPIXIVideoTexture(e){if(this._loadedTextures.containsKey(e))return this._loadedTextures.get(e);if(e==="")return this._invalidTexture;const i=A(this._resources,e,"video");if(!i)return u.warn('Unable to find video texture for resource "'+e+'".'),this._invalidTexture;const n=i.file;u.log('Loading video texture for resource "'+e+'"...');const t=l.Texture.from(n,{resourceOptions:{crossorigin:g(n)?"use-credentials":"anonymous"}}).on("error",r=>{c(n,r)});return this._loadedTextures.put(e,t),t}getInvalidPIXITexture(){return this._invalidTexture}loadTextures(e,i){const n=this._resources,t={};for(let a=0,d=n.length;a<d;++a){const o=n[a];if(o.file&&o.kind==="image"){if(this._loadedTextures.containsKey(o.name))continue;t[o.file]=t[o.file]?t[o.file].concat(o):[o]}}const r=Object.keys(t).length;if(r===0)return i(r);const x=l.Loader.shared;let T=0;const _=x.onProgress.add(function(){T++,e(T,r)});for(const a in t)t.hasOwnProperty(a)&&x.add({name:a,url:a,loadType:l.LoaderResource.LOAD_TYPE.IMAGE,crossOrigin:g(a)?"use-credentials":"anonymous"});x.load((a,d)=>{a.onProgress.detach(_);for(const o in d)if(d.hasOwnProperty(o)){if(!t.hasOwnProperty(o))continue;t[o].forEach(p=>{const h=d[o].texture;if(!h){const P=d[o].error;c(o,P);return}this._loadedTextures.put(p.name,h),I(h,p)})}i(r)})}}f.PixiImageManager=v,f.ImageManager=f.PixiImageManager})(gdjs||(gdjs={}));
//# sourceMappingURL=pixi-image-manager.js.map
